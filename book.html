<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Buku Kenangan ðŸ“–</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="topbar">
  <div class="brand">ðŸ“– Kenangan Kita</div>

  <div class="topActions">
    <a href="game.html" class="navBtn">ðŸŽ® Game Cinta</a>

    <div class="navPager">
      <button id="prev" class="iconBtn" title="Sebelumnya">â—€</button>
      <div id="pageInfo" class="pageInfo">1/1</div>
      <button id="next" class="iconBtn" title="Berikutnya">â–¶</button>
    </div>
  </div>
</header>


  <main class="wrap">
    <section class="book">
      <div class="page">
        <div class="photoWrap">
          <img id="photo" alt="Kenangan" />
        </div>
        <div class="caption">
          <div id="title" class="capTitle">â€”</div>
          <div id="text" class="capText">â€”</div>
        </div>
      </div>

      <div class="bookFooter">
        <button id="home" class="btn ghost" type="button">Kembali</button>
        <button id="replay" class="btn" type="button">Putar Musik Romantis ðŸŽµ</button>
      </div>

      <p class="muted small">Tip: kalau mau pakai musik, taruh file <b>music.mp3</b> di folder yang sama lalu aktifkan di source audio.</p>
    </section>
  </main>

 <script src="app.js"></script>
<script>
  ensureSeed();
  guardAuthOrGoHome();

  const slides = getSlides();
  const d = loadData();
  let idx = Math.min(d.lastIndex || 0, Math.max(0, slides.length - 1));

  const elPhoto = document.getElementById('photo');
  const elTitle = document.getElementById('title');
  const elText  = document.getElementById('text');
  const pageInfo= document.getElementById('pageInfo');

  function render() {
    const s = slides[idx];
    elPhoto.src = s.photo || '';
    elTitle.textContent = s.title || `Halaman ${idx+1}`;
    elText.textContent  = s.text || '';
    pageInfo.textContent = `${idx+1}/${slides.length}`;
    saveData({ lastIndex: idx });
  }

  document.getElementById('prev').onclick = () => { idx = (idx-1 + slides.length) % slides.length; render(); };
  document.getElementById('next').onclick = () => { idx = (idx+1) % slides.length; render(); };
  document.getElementById('home').onclick = () => { window.location.href = 'surprise.html'; };

  // Swipe mobile (tetap)
  let startX = null;
  document.addEventListener('touchstart', (e)=> startX = e.touches[0].clientX, {passive:true});
  document.addEventListener('touchend', (e)=>{
    if (startX == null) return;
    const dx = e.changedTouches[0].clientX - startX;
    startX = null;
    if (Math.abs(dx) < 40) return;
    if (dx < 0) document.getElementById('next').click();
    else document.getElementById('prev').click();
  }, {passive:true});

  initGlobalMusic();
  playGlobalMusic();
  render();
</script>

</body>
</html>
